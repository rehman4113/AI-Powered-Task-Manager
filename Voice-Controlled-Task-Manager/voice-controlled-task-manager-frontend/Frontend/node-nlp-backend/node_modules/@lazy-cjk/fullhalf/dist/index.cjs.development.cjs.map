{"version":3,"file":"index.cjs.development.cjs","sources":["../src/index.ts"],"sourcesContent":["\nimport { EnumFullHalfTableType, toFullWidthCharCode, toHalfWidthCharCode } from '@lazy-cjk/fullhalf-char-code';\nimport UString from 'uni-string';\nimport { all } from 'deepmerge';\nimport { tableFullHalf, ITableFullHalfDefaultIncludeKey, tableFullHalfDefaultInclude, ITableFullHalfObject } from '@lazy-cjk/fullhalf-data';\n\nlet typeOnly: IOptions = {\n\tonly: {\n\t\tnumber: true,\n\t},\n};\n\nexport const toFullNumber = factory<string>(toFullWidthCharCode, EnumFullHalfTableType.FULL_WIDTH, typeOnly);\nexport const toHalfNumber = factory<string>(toHalfWidthCharCode, EnumFullHalfTableType.HALF_WIDTH, typeOnly);\n\ntypeOnly = {\n\tonly: {\n\t\teng: true,\n\t},\n};\n\nexport const toFullEnglish = factory<string>(toFullWidthCharCode, EnumFullHalfTableType.FULL_WIDTH, typeOnly);\nexport const toHalfEnglish = factory<string>(toHalfWidthCharCode, EnumFullHalfTableType.HALF_WIDTH, typeOnly);\n\ntypeOnly = {\n\tonly: {\n\t\tdefault: true,\n\t},\n};\n\nexport const toFullWidth = factory<string>(toFullWidthCharCode, EnumFullHalfTableType.FULL_WIDTH, typeOnly);\nexport const toHalfWidth = factory<string>(toHalfWidthCharCode, EnumFullHalfTableType.HALF_WIDTH, typeOnly);\n\nexport function _optionsType(data: IOptionsType)\n{\n\tif (data)\n\t{\n\t\tif (typeof data.exists === 'boolean')\n\t\t{\n\t\t\tfor (let key in tableFullHalf[0])\n\t\t\t{\n\t\t\t\tif (key.indexOf('default') == 0)\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (data[key] !== false)\n\t\t\t\t{\n\t\t\t\t\tdata[key] = data.exists;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tdelete data.exists;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (typeof data.default === 'boolean')\n\t\t\t{\n\t\t\t\tfor (let key of tableFullHalfDefaultInclude)\n\t\t\t\t{\n\t\t\t\t\tif (data[key] !== false)\n\t\t\t\t\t{\n\t\t\t\t\t\tdata[key] = data.default;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tdelete data.default;\n\t\t\t}\n\n\t\t\tif (typeof data.not_default2 === 'boolean')\n\t\t\t{\n\t\t\t\tdata.both = data.space = data.not_default2;\n\t\t\t\tdelete data.not_default2;\n\t\t\t}\n\n\t\t\tif (typeof data.both === 'boolean')\n\t\t\t{\n\t\t\t\tdata.number = data.eng = data.both;\n\t\t\t\tdelete data.both;\n\t\t\t}\n\n\t\t\tif (typeof data.eng === 'boolean')\n\t\t\t{\n\t\t\t\tdata['a-z'] = data['A-Z'] = data.eng;\n\t\t\t\tdelete data.eng;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn data;\n}\n\nexport function _chkType(charCode: number, data: ITableFullHalfObject)\n{\n\tif (data.from && data.to && data.from <= charCode && charCode <= data.to)\n\t{\n\t\treturn true;\n\t}\n\telse if (data.values?.includes(charCode))\n\t{\n\t\treturn true;\n\t}\n}\n\nexport function chkType(charCode: number, key: ITableFullHalfDefaultIncludeKey, type: EnumFullHalfTableType)\n{\n\tlet data: ITableFullHalfObject = tableFullHalf[type][key];\n\n\t//console.log(charCode, data);\n\n\tif (Array.isArray(data.not) && data.not.length)\n\t{\n\t\tfor (let d of data.not)\n\t\t{\n\t\t\tif (_chkType(charCode, d))\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (_chkType(charCode, data))\n\t{\n\t\treturn true;\n\t}\n}\n\n//@ts-ignore\nexport function process<T, U = string>(str: unknown, charProcess: ICharProcessor, options: IOptions)\n{\n\tlet ret: number[] = [];\n\n\toptions.skip = _optionsType(options.skip);\n\toptions.only = _optionsType(options.only);\n\n\t//console.log(options);\n\n\tlet _str = Array.isArray(str) ? str : new UString(str);\n\n\tfor (let char of _str)\n\t{\n\t\tlet _skip: boolean;\n\n\t\t// @ts-ignore\n\t\t//let charCode = typeof char == 'number' ? char : char.charCodeAt();\n\t\tlet charCode = typeof char == 'number' ? char : char.codePointAt();\n\n\t\tif (options.only)\n\t\t{\n\t\t\t_skip = true;\n\n\t\t\tfor (let key in options.only)\n\t\t\t{\n\t\t\t\t//console.log(char, charCode, [key], chkType(charCode, key, options.type));\n\n\t\t\t\tif (options.only[key] && chkType(charCode, key as ITableFullHalfDefaultIncludeKey, options.type))\n\t\t\t\t{\n\t\t\t\t\t_skip = false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//console.log(char, charCode, _skip);\n\t\t}\n\n\t\tif (!_skip && options.skip)\n\t\t{\n\t\t\tfor (let key in options.skip)\n\t\t\t{\n\t\t\t\tif (options.skip[key] && chkType(charCode, key as ITableFullHalfDefaultIncludeKey, options.type))\n\t\t\t\t{\n\t\t\t\t\t_skip = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (_skip)\n\t\t{\n\t\t\tret.push(charCode);\n\t\t\tcontinue;\n\t\t}\n\n\t\tret.push(charProcess(charCode));\n\t}\n\n\tif (options.returnType)\n\t{\n\t\treturn ret as number[];\n\t}\n\n\t//return String.fromCharCode.apply(String, ret);\n\treturn String.fromCodePoint.apply(String, ret);\n}\n\nexport function factory<T = string>(charProcessor: ICharProcessor,\n\ttype: number | EnumFullHalfTableType,\n\toverwriteOptions?: IOptions\n): IFactoryFn\n{\n\t//const deepmerge = require('deepmerge');\n\n\t// @ts-ignore\n\treturn (str, options?: IOptions) =>\n\t{\n\t\toptions = all([\n\t\t\t{\n\t\t\t\t//skip: {},\n\t\t\t}, options || {}, overwriteOptions || {}, {\n\t\t\t\ttype: type,\n\t\t\t},\n\t\t]);\n\n\t\t//console.log(options);\n\n\t\treturn process<T>(str, charProcessor, options);\n\t};\n}\n\nexport function _filterTable(data: ITableFullHalfObject)\n{\n\tlet _a: number[] = [];\n\n\tif (data.from && data.to)\n\t{\n\t\tfor (let i = data.from; i <= data.to; i++)\n\t\t{\n\t\t\t_a.push(i);\n\t\t}\n\t}\n\n\tif (data.values)\n\t{\n\t\t_a = _a.concat(data.values)\n\t}\n\n\tif (Array.isArray(data.not) && data.not.length)\n\t{\n\t\t_a = _a.filter(function (charCode)\n\t\t{\n\t\t\tfor (let d of data.not)\n\t\t\t{\n\t\t\t\tif (_chkType(charCode, d))\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn true;\n\t\t});\n\t}\n\n\treturn _a;\n}\n\nexport interface IOptionsType extends Partial<Record<ITableFullHalfDefaultIncludeKey, boolean>>\n{\n\teng?: boolean,\n\tnumber?: boolean,\n\n\t/**\n\t * eng & number\n\t */\n\tboth?: boolean;\n\n\tspace?: boolean;\n\texists?: boolean;\n\n\tdefault?: boolean;\n\tnot_default?: boolean;\n\tnot_default2?: boolean;\n\n\tslash?: boolean;\n\tbracket?: boolean;\n\n\t[index: string]: boolean;\n}\n\nexport interface IOptionsBase\n{\n\ttype?: number;\n\n\tskip?: IOptionsType;\n\tonly?: IOptionsType;\n\n\tmode?: {\n\t\tonly?: boolean,\n\n\t\t[index: string]: boolean;\n\t};\n}\n\nexport type IOptionsTrue = IOptionsBase & {\n\n\t/**\n\t * 回傳直接回傳陣列而不組合成字串\n\t */\n\treturnType: ILazyTrue;\n\n}\n\nexport type IOptionsFalse = IOptionsBase & {\n\n\t/**\n\t * 回傳直接回傳陣列而不組合成字串\n\t */\n\treturnType?: ILazyFalse;\n\n}\n\nexport interface IOptions extends IOptionsBase\n{\n\n\t/**\n\t * 回傳直接回傳陣列而不組合成字串\n\t */\n\treturnType?: ILazyTrue | ILazyFalse;\n\n}\n\ntype ILazyTrue = true | 1;\ntype ILazyFalse = 0 | false | void | undefined | null;\n\nexport interface IFactoryFn\n{\n\t(str: string | string[], options?: IOptionsFalse): string\n\n\t(str: (string | number)[], options: IOptionsTrue): number[]\n\n\t(str: unknown, options: IOptionsTrue): number[]\n\n\t(str: (string | number)[]): string\n\n\t(str: (string | number)[], options?: IOptionsFalse): string\n\n\t(str: unknown, options: IOptionsFalse): string\n\n\t(str: unknown, options: IOptions): string | number[]\n}\n\nexport type ICharProcessor = (charCode: number) => number\n\nexport default {\n\ttoFullNumber,\n\ttoHalfNumber,\n\n\ttoFullEnglish,\n\ttoHalfEnglish,\n\n\ttoFullWidth,\n\ttoHalfWidth,\n}\n"],"names":["typeOnly","only","number","toFullNumber","factory","toFullWidthCharCode","toHalfNumber","toHalfWidthCharCode","eng","toFullEnglish","toHalfEnglish","default","toFullWidth","toHalfWidth","_optionsType","data","exists","key","tableFullHalf","indexOf","tableFullHalfDefaultInclude","not_default2","both","space","_chkType","charCode","_data$values","from","to","values","includes","chkType","type","Array","isArray","not","length","d","process","str","charProcess","options","ret","skip","_str","UString","char","_skip","codePointAt","push","returnType","String","fromCodePoint","apply","charProcessor","overwriteOptions","all","_filterTable","_a","i","concat","filter"],"mappings":";;;;;;;;;AAMA,IAAIA,QAAQ,GAAa;AACxBC,EAAAA,IAAI,EAAE;AACLC,IAAAA,MAAM,EAAE,IAAA;AACR,GAAA;CACD,CAAA;AAEM,MAAMC,YAAY,gBAAGC,OAAO,CAASC,oCAAmB,EAAA,CAAA,yCAAoCL,QAAQ,EAAC;AACrG,MAAMM,YAAY,gBAAGF,OAAO,CAASG,oCAAmB,EAAA,CAAA,yCAAoCP,QAAQ,EAAC;AAE5GA,QAAQ,GAAG;AACVC,EAAAA,IAAI,EAAE;AACLO,IAAAA,GAAG,EAAE,IAAA;AACL,GAAA;CACD,CAAA;AAEM,MAAMC,aAAa,gBAAGL,OAAO,CAASC,oCAAmB,EAAA,CAAA,yCAAoCL,QAAQ,EAAC;AACtG,MAAMU,aAAa,gBAAGN,OAAO,CAASG,oCAAmB,EAAA,CAAA,yCAAoCP,QAAQ,EAAC;AAE7GA,QAAQ,GAAG;AACVC,EAAAA,IAAI,EAAE;AACLU,IAAAA,OAAO,EAAE,IAAA;AACT,GAAA;CACD,CAAA;AAEM,MAAMC,WAAW,gBAAGR,OAAO,CAASC,oCAAmB,EAAA,CAAA,yCAAoCL,QAAQ,EAAC;AACpG,MAAMa,WAAW,gBAAGT,OAAO,CAASG,oCAAmB,EAAA,CAAA,yCAAoCP,QAAQ,EAAC;AAErG,SAAUc,YAAYA,CAACC,IAAkB,EAAA;AAE9C,EAAA,IAAIA,IAAI,EACR;AACC,IAAA,IAAI,OAAOA,IAAI,CAACC,MAAM,KAAK,SAAS,EACpC;AACC,MAAA,KAAK,IAAIC,GAAG,IAAIC,0BAAa,CAAC,CAAC,CAAC,EAChC;QACC,IAAID,GAAG,CAACE,OAAO,CAAC,SAAS,CAAC,IAAI,CAAC,EAC/B;AACC,UAAA,SAAA;AACD,SAAA;AAEA,QAAA,IAAIJ,IAAI,CAACE,GAAG,CAAC,KAAK,KAAK,EACvB;AACCF,UAAAA,IAAI,CAACE,GAAG,CAAC,GAAGF,IAAI,CAACC,MAAM,CAAA;AACxB,SAAA;AACD,OAAA;MAEA,OAAOD,IAAI,CAACC,MAAM,CAAA;AACnB,KAAC,MAED;AACC,MAAA,IAAI,OAAOD,IAAI,CAACJ,OAAO,KAAK,SAAS,EACrC;AACC,QAAA,KAAK,IAAIM,GAAG,IAAIG,wCAA2B,EAC3C;AACC,UAAA,IAAIL,IAAI,CAACE,GAAG,CAAC,KAAK,KAAK,EACvB;AACCF,YAAAA,IAAI,CAACE,GAAG,CAAC,GAAGF,IAAI,CAACJ,OAAO,CAAA;AACzB,WAAA;AACD,SAAA;QAEA,OAAOI,IAAI,CAACJ,OAAO,CAAA;AACpB,OAAA;AAEA,MAAA,IAAI,OAAOI,IAAI,CAACM,YAAY,KAAK,SAAS,EAC1C;QACCN,IAAI,CAACO,IAAI,GAAGP,IAAI,CAACQ,KAAK,GAAGR,IAAI,CAACM,YAAY,CAAA;QAC1C,OAAON,IAAI,CAACM,YAAY,CAAA;AACzB,OAAA;AAEA,MAAA,IAAI,OAAON,IAAI,CAACO,IAAI,KAAK,SAAS,EAClC;QACCP,IAAI,CAACb,MAAM,GAAGa,IAAI,CAACP,GAAG,GAAGO,IAAI,CAACO,IAAI,CAAA;QAClC,OAAOP,IAAI,CAACO,IAAI,CAAA;AACjB,OAAA;AAEA,MAAA,IAAI,OAAOP,IAAI,CAACP,GAAG,KAAK,SAAS,EACjC;QACCO,IAAI,CAAC,KAAK,CAAC,GAAGA,IAAI,CAAC,KAAK,CAAC,GAAGA,IAAI,CAACP,GAAG,CAAA;QACpC,OAAOO,IAAI,CAACP,GAAG,CAAA;AAChB,OAAA;AACD,KAAA;AACD,GAAA;AAEA,EAAA,OAAOO,IAAI,CAAA;AACZ,CAAA;AAEgB,SAAAS,QAAQA,CAACC,QAAgB,EAAEV,IAA0B,EAAA;AAAA,EAAA,IAAAW,YAAA,CAAA;AAEpE,EAAA,IAAIX,IAAI,CAACY,IAAI,IAAIZ,IAAI,CAACa,EAAE,IAAIb,IAAI,CAACY,IAAI,IAAIF,QAAQ,IAAIA,QAAQ,IAAIV,IAAI,CAACa,EAAE,EACxE;AACC,IAAA,OAAO,IAAI,CAAA;AACZ,GAAC,MACI,IAAAF,CAAAA,YAAA,GAAIX,IAAI,CAACc,MAAM,MAAA,IAAA,IAAAH,YAAA,KAAA,KAAA,CAAA,IAAXA,YAAA,CAAaI,QAAQ,CAACL,QAAQ,CAAC,EACxC;AACC,IAAA,OAAO,IAAI,CAAA;AACZ,GAAA;AACD,CAAA;SAEgBM,OAAOA,CAACN,QAAgB,EAAER,GAAoC,EAAEe,IAA2B,EAAA;EAE1G,IAAIjB,IAAI,GAAyBG,0BAAa,CAACc,IAAI,CAAC,CAACf,GAAG,CAAC,CAAA;AAIzD,EAAA,IAAIgB,KAAK,CAACC,OAAO,CAACnB,IAAI,CAACoB,GAAG,CAAC,IAAIpB,IAAI,CAACoB,GAAG,CAACC,MAAM,EAC9C;AACC,IAAA,KAAK,IAAIC,CAAC,IAAItB,IAAI,CAACoB,GAAG,EACtB;AACC,MAAA,IAAIX,QAAQ,CAACC,QAAQ,EAAEY,CAAC,CAAC,EACzB;AACC,QAAA,OAAO,KAAK,CAAA;AACb,OAAA;AACD,KAAA;AACD,GAAA;AAEA,EAAA,IAAIb,QAAQ,CAACC,QAAQ,EAAEV,IAAI,CAAC,EAC5B;AACC,IAAA,OAAO,IAAI,CAAA;AACZ,GAAA;AACD,CAAA;AAEA;SACgBuB,OAAOA,CAAgBC,GAAY,EAAEC,WAA2B,EAAEC,OAAiB,EAAA;EAElG,IAAIC,GAAG,GAAa,EAAE,CAAA;EAEtBD,OAAO,CAACE,IAAI,GAAG7B,YAAY,CAAC2B,OAAO,CAACE,IAAI,CAAC,CAAA;EACzCF,OAAO,CAACxC,IAAI,GAAGa,YAAY,CAAC2B,OAAO,CAACxC,IAAI,CAAC,CAAA;AAIzC,EAAA,IAAI2C,IAAI,GAAGX,KAAK,CAACC,OAAO,CAACK,GAAG,CAAC,GAAGA,GAAG,GAAG,IAAIM,OAAO,CAACN,GAAG,CAAC,CAAA;AAEtD,EAAA,KAAK,IAAIO,IAAI,IAAIF,IAAI,EACrB;AACC,IAAA,IAAIG,KAAc,CAAA;AAElB;AAEA,IAAA,IAAItB,QAAQ,GAAG,OAAOqB,IAAI,IAAI,QAAQ,GAAGA,IAAI,GAAGA,IAAI,CAACE,WAAW,EAAE,CAAA;IAElE,IAAIP,OAAO,CAACxC,IAAI,EAChB;AACC8C,MAAAA,KAAK,GAAG,IAAI,CAAA;AAEZ,MAAA,KAAK,IAAI9B,GAAG,IAAIwB,OAAO,CAACxC,IAAI,EAC5B;AAGC,QAAA,IAAIwC,OAAO,CAACxC,IAAI,CAACgB,GAAG,CAAC,IAAIc,OAAO,CAACN,QAAQ,EAAER,GAAsC,EAAEwB,OAAO,CAACT,IAAI,CAAC,EAChG;AACCe,UAAAA,KAAK,GAAG,KAAK,CAAA;AACb,UAAA,MAAA;AACD,SAAA;AACD,OAAA;AAGD,KAAA;AAEA,IAAA,IAAI,CAACA,KAAK,IAAIN,OAAO,CAACE,IAAI,EAC1B;AACC,MAAA,KAAK,IAAI1B,GAAG,IAAIwB,OAAO,CAACE,IAAI,EAC5B;AACC,QAAA,IAAIF,OAAO,CAACE,IAAI,CAAC1B,GAAG,CAAC,IAAIc,OAAO,CAACN,QAAQ,EAAER,GAAsC,EAAEwB,OAAO,CAACT,IAAI,CAAC,EAChG;AACCe,UAAAA,KAAK,GAAG,IAAI,CAAA;AACZ,UAAA,MAAA;AACD,SAAA;AACD,OAAA;AACD,KAAA;AAEA,IAAA,IAAIA,KAAK,EACT;AACCL,MAAAA,GAAG,CAACO,IAAI,CAACxB,QAAQ,CAAC,CAAA;AAClB,MAAA,SAAA;AACD,KAAA;AAEAiB,IAAAA,GAAG,CAACO,IAAI,CAACT,WAAW,CAACf,QAAQ,CAAC,CAAC,CAAA;AAChC,GAAA;EAEA,IAAIgB,OAAO,CAACS,UAAU,EACtB;AACC,IAAA,OAAOR,GAAe,CAAA;AACvB,GAAA;EAGA,OAAOS,MAAM,CAACC,aAAa,CAACC,KAAK,CAACF,MAAM,EAAET,GAAG,CAAC,CAAA;AAC/C,CAAA;SAEgBtC,OAAOA,CAAakD,aAA6B,EAChEtB,IAAoC,EACpCuB,gBAA2B,EAAA;AAK3B;AACA,EAAA,OAAO,CAAChB,GAAG,EAAEE,OAAkB,KAAI;AAElCA,IAAAA,OAAO,GAAGe,aAAG,CAAC,CACb,EAEC,EAAEf,OAAO,IAAI,EAAE,EAAEc,gBAAgB,IAAI,EAAE,EAAE;AACzCvB,MAAAA,IAAI,EAAEA,IAAAA;AACN,KAAA,CACD,CAAC,CAAA;AAIF,IAAA,OAAOM,OAAO,CAAIC,GAAG,EAAEe,aAAa,EAAEb,OAAO,CAAC,CAAA;GAC9C,CAAA;AACF,CAAA;AAEM,SAAUgB,YAAYA,CAAC1C,IAA0B,EAAA;EAEtD,IAAI2C,EAAE,GAAa,EAAE,CAAA;AAErB,EAAA,IAAI3C,IAAI,CAACY,IAAI,IAAIZ,IAAI,CAACa,EAAE,EACxB;AACC,IAAA,KAAK,IAAI+B,CAAC,GAAG5C,IAAI,CAACY,IAAI,EAAEgC,CAAC,IAAI5C,IAAI,CAACa,EAAE,EAAE+B,CAAC,EAAE,EACzC;AACCD,MAAAA,EAAE,CAACT,IAAI,CAACU,CAAC,CAAC,CAAA;AACX,KAAA;AACD,GAAA;EAEA,IAAI5C,IAAI,CAACc,MAAM,EACf;IACC6B,EAAE,GAAGA,EAAE,CAACE,MAAM,CAAC7C,IAAI,CAACc,MAAM,CAAC,CAAA;AAC5B,GAAA;AAEA,EAAA,IAAII,KAAK,CAACC,OAAO,CAACnB,IAAI,CAACoB,GAAG,CAAC,IAAIpB,IAAI,CAACoB,GAAG,CAACC,MAAM,EAC9C;AACCsB,IAAAA,EAAE,GAAGA,EAAE,CAACG,MAAM,CAAC,UAAUpC,QAAQ,EAAA;AAEhC,MAAA,KAAK,IAAIY,CAAC,IAAItB,IAAI,CAACoB,GAAG,EACtB;AACC,QAAA,IAAIX,QAAQ,CAACC,QAAQ,EAAEY,CAAC,CAAC,EACzB;AACC,UAAA,OAAO,KAAK,CAAA;AACb,SAAA;AACD,OAAA;AAEA,MAAA,OAAO,IAAI,CAAA;AACZ,KAAC,CAAC,CAAA;AACH,GAAA;AAEA,EAAA,OAAOqB,EAAE,CAAA;AACV,CAAA;AAyFA,YAAe;EACdvD,YAAY;EACZG,YAAY;EAEZG,aAAa;EACbC,aAAa;EAEbE,WAAW;AACXC,EAAAA,WAAAA;CACA;;;;;;;;;;;;;;;;"}